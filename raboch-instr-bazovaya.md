<!-- TITLE: Рабочая инструкция пользователя системы «ВИТАКОР» -->
<!-- SUBTITLE: ОМС-Финанс (Базовая) -->

# Введение

Настоящее руководство (далее – Руководство) является частью комплекта справочной документации по приложениям компании «Витакор» (далее – приложение, информационная система, система).

В настоящем руководстве приведены описания базовых принципов функционирования приложений и универсальных элементов интерфейса. Ознакомившись с настоящим руководством, пользователь получит информацию о приемах работы с приложениями и функциях, общих для всех приложений. В руководствах пользователя и администратора по конкретным программным продуктам и модулям описывается только методология работы с ними и специфичный для данных приложений функционал.

Программные продукты компании «Витакор» реализованы как приложения для операционной среды Windows.
Настоящее руководство рассчитано на пользователя, владеющего базовыми навыками работы в операционной системе Windows

# Условные обозначения



|||
| ------------- | ------------- |
| <> |В угловых скобках приводится наименование кнопки или пункта меню системы, например <Окно>, <ОК>.|
| -> |Стрелкой обозначается последовательность вызова функций приложения. Функции обозначаются названиями (подписями) управляющих элементов, наименованиями клавиш и т.д., например, пунктов меню системы: <Окно>-><Папки>.|
| [] |В квадратных скобках приводится наименование клавиши, например: [Tab].Символ «+» между обозначениями клавиш подразумевает одновременное нажатие клавиш, например [Shift]+[Tab].|

# Базовые сведения о системе
## Архитектура

Приложение, с которым работает пользователь, является частью программного комплекса, который включает:
* 	систему хранения данных (базу данных),
* 	серверную часть программного обеспечения,
* 	клиентскую часть программного обеспечения (клиентское приложение).

Клиентское приложение представляет собой исполняемый файл, сопровождаемый набором вспомогательных файлов – файлов конфигурации, библиотек и т.д. Как правило, все файлы, необходимые для работы клиентского приложения, хранятся в одной папке.

Хранение данных в системе организуется с помощью т.н. сущностей. Сущность – это логическая модель какого-либо реально существующего объекта – например, организации, физического лица, документа и т.д., факт существования и определенные характеристики которого необходимо учесть в системе. Сущность идентифицируется в системе и описывается с помощью атрибутов. Атрибут сущности соответствует параметру, характеризующему объект.

Например, в системе необходим учет такого объекта, как пациент. Любой пациент имеет такие параметры, как фамилия, имя, дата рождения. Соответственно в системе создается сущность «Пациент», обладающая атрибутами «Фамилия», «Имя», «Дата рождения». Экземпляры данной сущности – это записи вида: Иванов, Иван, 01.01.1980; или Петрова, Ирина, 02.02.1990 и т.д.

Более подробная информация о сущностях и атрибутах приведена в документе Руководство пользователя. Генератор выражений (раздел Общие сведения о системе).

## Организация доступа

Поскольку приложения работают с базами данных, информация в которых может быть конфиденциальной, пользователь системы должен быть зарегистрирован. Регистрация пользователя производится администратором и означает создание для каждого пользователя учетной записи, которая хранится в базе данных системы. Учетная запись содержит сведения о пользователе, позволяющие его идентифицировать, имя пользователя (логин), данные о пароле и о правах, предоставленных данному пользователю.

Под правами пользователя понимаются права доступа к функциям системы, сущностям и т.д.

Имя пользователя, или логин - это уникальный идентификатор пользователя в рамках системы. Пароль представляет собой строку текста, которую должен знать только пользователь системы. Это позволяет обеспечить соответствие логина пользователя и реального человека.

Регистрация пользователей ведется с целью обеспечения сохранности данных системы путем контроля доступа к данным, ведения журнала действий пользователя и т.д. Поэтому при входе в систему обязательно производится т.н. авторизация (или аутентификация) пользователя. Авторизация – это процесс идентификации (определения) пользователя системы, который аналогичен процессу установления личности, например, при обращении в банк.

## Интерфейс

Все, с помощью чего информационная система обменивается информацией с внешним миром, называется интерфейсом. Интерфейс может быть визуальным – например: окна, экранные формы, отчеты и т.д., которые видит пользователь при работе с системой; и не визуальным – интерфейсы для обмена данными с другими информационными системами или оборудованием.

В операционной среде Windows основными элементами визуального интерфейса являются окна (экранные формы). Экранные формы содержат различные визуальные элементы для представления данных, а также для управления данными и самими формами. Элементы управления могут быть различными по назначению и сложности, но их набор ограничен для удобства работы с системой – для решения однотипных задач используются однотипные элементы. Базовые визуальные элементы управления экранных форм описаны в п.5 настоящего руководства. Более сложные и специализированные элементы управления описаны в соответствующих разделах настоящего руководства и отдельных руководствах по модулям системы.

Как и большинство Windows-приложений, программы компании «Витакор» имеют т.н. главное окно, которое открывается при запуске системы и предоставляет доступ ко всем функциям приложения. Структура и функции главного окна описаны в [п. 3](#b1)Руководства.

При работе с приложениями следует иметь в виду, что многие элементы интерфейса системы (пункты меню, кнопки и т.д.) контекстно-зависимы, т.е. их состав, внешний вид и доступность могут изменяться в зависимости текущего режима работы программы и прав доступа, предоставленных пользователю приложения.

## Контроль ввода данных (валидация)

Экранные формы, предназначенные для ввода данных в систему, имеют встроенные инструменты контроля правильности вводимых данных (валидации). Для контроля ввода данных применяются:
* 	поля ввода данных определенного типа (числовые поля не допускают ввод букв и т.д.),
* 	маски ввода (см. ниже),
*  ограничение вводимых данных списками выбора и справочниками,
* 	процедуры проверки данных при переходе на другой элемент формы ввода данных,
* 	процедуры проверки данных при сохранении формы ввода данных.

Маска ввода представляет собой шаблон, применяемый в тех случаях, когда вводимое значение имеет строгий формат. Шаблон может ограничивать количество символов, перечень допустимых символов, а также позволяет включать автоматически обязательные символы. Для пользователя маска ввода выглядит как строка символов. Очень часто маску применяют при вводе даты, телефонного номера и т.д., т.к. они имеют определенный формат. Например, маска ввода даты может иметь вид «__.__.____» или «__.__.». Символ подчеркивания в маске соответствует позиции ввода. Остальные символы являются составной частью вводимого значения – точка, дефис, пробел, скобки и т.д.

Даже если введенное значение удовлетворяет требованию формата, оно может быть некорректным по смыслу. Например, правильно введенная дата окончания периода может быть меньше даты начала периода. Такого рода ситуации отслеживаются специальными процедурами валидации. При обнаружении ошибок процедурами валидации выводятся специальные сообщения ([см. п. 6.3](#b2)).

## Терминология и приемы работы 


В дальнейшем при описании функциональности приложения используются следующие термины:

|||
| ------------- | ------------- |
|Курсор|Средство отображения текущей позиции для ввода текста на экране. В полях ввода данных имеет вид вертикальной черты. В списках и табличных формах курсор имеет вид выделенной контрастным цветом строки или ячейки списка (таблицы). Курсор также является средством отображения наличия фокуса на данном элементе управления.|
|Указатель мыши|Указатель мыши предоставляет альтернативный по отношению к клавиатуре способ доступа к элементам визуального интерфейса системы. Указатель мыши может иметь различные формы в зависимости от текущего контекста:<br> ![1](/uploads/007/1-.png "1")- стандартный вид указателя,<br> ![2](/uploads/007/2-.png "2")- вид, применяемый при наведении указателя на ссылку,<br> ![6](/uploads/007/6-.png "6")- вид, применяемый при помещении в область текстового поля.|
|Щелчок (или клик) кнопкой мыши|Если не указано иное, имеется в виду одинарный щелчок левой кнопкой мыши (т.е. нажатие и отпускание кнопки).|
|Двойной щелчок (двойной клик)|Комбинация двух щелчков подряд левой кнопкой мыши|
|Перетаскивание|Действие, когда пользователь, наведя указатель мыши на нужный объект интерфейса, нажимает левую кнопку мыши, и, удерживая ее нажатой, перемещает указать мыши в определенное место интерфейса системы. Во время операции перетаскивания указатель мыши может принимать вид:<br> ![3](/uploads/007/3-.png "3")- обычное перетаскивание,<br> ![4](/uploads/007/4-.png "4")- перетаскивание с копированием,<br> ![5](/uploads/007/5-.png "5")- такой вид указатель принимает при попытке перетащить мышью объект в недопустимое место экранной формы.|
|Горячие клавиши|За определенной функцией приложения может быть зарезервирована определенная клавиша или, чаще всего, комбинация клавиш клавиатуры. Эти так называемые «горячие» клавиши позволяют осуществить быстрый вызов данной функции системы без использования таких средств навигации, как перемещение по форме с помощью мыши, клавиши [Tab] или пунктов меню системы.<br>Доступ к функциям с помощью горячих клавиш подчиняется тем же правилам, что и доступ с помощью визуальных элементов интерфейса. Т.е. если в данный момент функция недоступна для выбора, горячие клавиши также не сработают.

Любой элемент управления экранной формы может приобретать и терять «фокус», т.е. становиться активным или неактивным. Активный элемент (находящийся в фокусе, или «имеющий фокус») готов к получению данных (готов к приему команды). Наличие фокуса отображается визуально – как правило, с помощью пунктирной рамки, охватывающей площадь элемента управления. Для некоторых элементов индикатор активности может выглядеть по-другому и это включено в описание соответствующего элемента управления в [разделе 5](#b3).

Перемещение фокуса между элементами управления формы производится либо с помощью мыши, либо с помощью клавиши [Tab]. Нажатие [Tab] переключает фокус на элемент, следующий по порядку  за текущим. [Shift+Tab] – позволяет перемещаться по элементам формы в обратном порядке. Клик мышью на элементе передает ему фокус независимо от установленного порядка следования элементов на форме. С помощью клавиатуры изменять состояние элемента можно, только если он находится в фокусе.

В случае использования мыши сам внешний вид элемента подсказывает возможные действия (кнопки нажимаются кликом мыши, элементы списка выбираются двойным кликом и т.д.). При использовании клавиатуры необходимо запомнить простые правила работы с определенными элементами правления (эти правила приведены в описаниях элементов). При использовании мыши не требуется знать правил обращения с элементами управления, но при помощи клавиатуры скорость работы с формами ввода данных может быть значительно выше.


<a name="b1"></a>
# Основные действия пользователя
## Запуск приложения
При установке приложения на компьютер пользователя администратор создает ярлыки быстрого доступа к приложению. Как правило, ярлыки создаются на рабочем столе Windows, в списке программ и на панели быстрого запуска и имеют подсказку, соответствующую наименованию программы. Внешний вид ярлыка приложения зависит от конкретного приложения.

При запуске приложения проверяется наличие обновлений программного обеспечения. Если они обнаружены, производится обновление клиентского приложения на компьютере пользователя. Если обновления отсутствуют, об этом выводится сообщение (см. Рис.).

![1](/uploads/007/1.png "1")  ![2](/uploads/007/2.png "2")

Затем запускается само приложение, которое первым шагом запрашивает авторизацию пользователя – его имя и пароль. Соответствующий диалог показан на Рис.

После успешной авторизации открывается главное окно приложения ([см. п. 3.2](#b4)). Если авторизация не выполнена (введено несуществующее имя пользователя или неправильный пароль) или пользователь отказался от авторизации кнопкой <Отмена>, приложение не запускается.

## Выход из приложения

Выход из приложения по окончании работы может быть произведен:
* 	с помощью главного меню приложения: <Файл>  <Выход>;
* 	стандартным приемом закрытия экранной формы (кнопка закрытия в правом верхнем углу главного окна приложения или нажатие клавиш [Alt+F4]).
	
В любом случае при попытке выхода из программы система выведет запрос на подтверждение, показанный на рисунке ниже. Подтверждение запрашивается во избежание случайного закрытия окна программы.

![3](/uploads/007/3.png "3")

## Смена пароля

Пользователь при необходимости может изменить свой пароль входа в систему. Это делается с помощью главного меню приложения: <Настройки> ->><Сменить пароль>. При этом выводится диалоговое окно изменения пароля, показанное на Рис.

![4](/uploads/007/4.png "4")

В окне диалога требуется ввести действующий (текущий) пароль, новый пароль и затем подтвердить новый пароль повторным вводом в поле «Подтверждение». Кнопка <ОК> сохранит информацию об измененном пароле в базе данных. При следующем входе в систему потребуется ввод нового пароля. Кнопкой <Отмена> можно отказаться от операции изменения пароля.
# Главное окно приложения
![5](/uploads/007/5.jpg "5")

Главные окна всех приложений компании «Витакор» имеют одинаковую структуру. Главное окно приложения на примере системы «АПС Витакор» представлено на Рис.и содержит следующие области:
* 	Заголовок окна приложения содержит пиктограмму, наименование приложения и имя (логин) текущего пользователя системы.
* 	Под заголовком окна располагается главное меню системы.
* 	Ниже главного меню располагается панель инструментов приложения, содержащая контекстно-зависимый  набор кнопок быстрого доступа к функциям системы.
* 	Всю нижнюю часть формы занимает панель статуса, на которой отображается дополнительная информация при работе с приложением.
* 	Оставшуюся часть окна делят панель структуры приложения (слева) и панель отображения данных (справа).
	
Интерфейс приложения является многооконным, т.е. в рамках главного окна может быть открыто множество подокон (далее – просто «окно») для отображения данных.

Элементы управления приложения (пункты меню, кнопки и пр.), недоступные в соответствии с заданными правами пользователя, скрываются. Т.е. пользователи системы, имеющие различные наборы прав, могут видеть разный состав пунктов меню системы и разный набор кнопок.

## Главное меню

Главное меню приложения представляет собой набор пунктов меню, состав которого зависит от вида приложения. При этом оно всегда содержит пункты, описанные в таблице:

|||
| ------------- | ------------- |
|<Файл>|Меню «Файл» включает пункты для управления запущенным приложением:<br><Закрыть><br><Выход> - закрыть главное окно приложения (выйти из программы).|
|<Сервис>|Предоставляет доступ к сервисным функциям приложения. Сервисные функции описаны в соответствующих руководствах пользователя и администратора.|
|<Настройки>|Меню включает подпункты, соответствующие функциям для настройки приложения, т.е. указания различных базовых параметров, влияющих на функциональность системы. Подробно настройки описаны в руководстве администратора по настройкам.|
|<Окно>|Меню содержит функции управления окнами приложения (подробно о работе с окнами системы [см. п. 4.5](#b5)):<br><Закрыть все> - позволяет закрыть все открытые окна приложения,<br><Окна…> - отображает полный список открытых окон системы для управления ими: переключения в выбранное окно или его закрытие.<br>Переключатель <Папки> включает/отключает отображение панели структуры приложения ([см. п. 4.3](#b6)),<br>Переключатель <Избранное> включает/отключает отображение панели «Избранное» ([см. п. 4.4](#b7)).|
|<Справка>|Меню для предоставления справочной информации о системе:<br><О программе…> показывает диалоговое окно с отображением базовой информации о системе: производителе системы, номерах версий, установленных компонентах и пр.,<br><Новости> открывает в области данных окно с новостями разработчика приложения.|

Троеточие, добавляемое в конце заголовка пункта меню, означает, что выбор пункта меню откроет дополнительное диалоговое окно перед непосредственным выполнением команды.
Горячие клавиши ([см. Табл. 5.1](#b3) Базовые элементы интерфейса), соответствующие пункту меню системы, указываются после заголовка пункта меню, например <Закрыть Alt+A>.

## Панель инструментов

Панель инструментов приложения является контекстно-зависимой и разбита на несколько областей:
* Кнопки быстрого доступа – их набор зависит от вида запущенного приложения, т.е. состав кнопок будет разным для разных приложений («РМИС», «АПС», «СПК» и т.д.);
* Область управления активным окном (как правило, содержит кнопки сохранения, добавления удаления, и т.п.) их набор зависит от типа окна (список, форма ввода) и конкретного вида окна. Элементы панели инструментов описаны для каждого конкретного вида формы в соответствующих руководствах.

## Панель структуры («Папки»)	

Панель структуры приложения содержит древовидный (иерархический) список, позволяющий отобразить перечень задач системы, сгруппированных по разделам (папкам). В дереве папок видны только те разделы, к которым у пользователя есть доступ в соответствии с его правами.

Панель структуры отображается по умолчанию, но может быть скрыта (например, для высвобождения места для панели отображения данных) с помощью переключателя <Окно> -->> <Папки> главного меню приложения. Этот же переключатель позволяет вновь отобразить панель, когда это необходимо.

Двойной клик мышью на заголовке раздела, не имеющего вложенных элементов (подразделов), открывает окно (форму) в области отображения данных ([см. п. 4.5](#b5)), соответствующее данному разделу.

## Панель «Избранное»

С помощью панели «Избранное» может быть настроен быстрый доступ к данным системы. На эту панель с помощью перетаскивания мышью может быть помещена любая из форм, открытых в области отображения данных или даже конкретная запись из открытой табличной формы.
Содержимое панели организуется в виде древовидного списка. Для организации содержимого панели можно создавать папки и подпапки с помощью контекстного меню.
Папки и ярлыки на панели «Избранное» видны только пользователю, создавшему их.

## Область отображения данных


Каждая новая открытая форма (окно) приложения помещается в область отображения данных в виде вкладки (исключение составляют так называемые диалоговые окна, см. п. 6). В верхней части области данных располагаются ярлыки всех открытых в данный момент вкладок, каждый ярлык содержит заголовок открытой формы. Всю остальную площадь области отображения данных занимает содержимое активной на данный момент вкладки. Ярлыки позволяют видеть, какие формы (окна) системы открыты, и переключаться между ними.

В правом верхнем углу области расположены кнопки управления набором вкладок. Кнопки стрелок (влево и вправо)  ![M 1](/uploads/007/m-1.jpg "M 1") позволяют переместить фокус с текущей вкладки на соседнюю (сделать активной вкладку) слева или справа. Кнопка ![M 2](/uploads/007/m-2.jpg "M 2")  позволяет закрыть текущую активную вкладку.

Если на вкладке имеются несохраненные данные, в заголовке вкладки отображается символ «*». При попытке закрытия такой вкладки будет выведен запрос на сохранение внесенных изменений.

Если вкладок открыто много и все ярлыки не помещаются в видимой части формы, управлять открытыми окнами можно с помощью пункта главного меню <Окно>.

<a name="b3"></a>
# Базовые элементы интерфейса	

Данный раздел описывает базовые универсальные элементы, с помощью которых строятся интерфейсы приложений. К базовым элементам относятся простейшие элементы, такие как кнопки, поля и т.п., из которых строятся экранные формы в Windows.
Элемент управления, недоступный пользователю в текущий момент времени, будет представлен в сером цвете, например: ![M 3](/uploads/007/m-3.jpg "M 3") . Поля ввода, недоступные для изменения, имеют серый цвет фона.

## Кнопка	



Один из самых распространенных элементов управления. Представляет собой область формы, обозначенную пиктограммой и/или надписью, и которая может быть нажата с помощью мыши или клавиши [Enter] (при условии, что кнопка находится в фокусе).

Нажатие на кнопку запускает выполнение какой-либо функции приложения. Кнопки могут иметь различный внешний вид, например:
* 	 ![M 4](/uploads/007/m-4.jpg "M 4") классический («объемный») вид кнопки (как правило, используется в диалоговых окнах),
* 	![M 5](/uploads/007/m-5.jpg "M 5") «плоский» вид кнопки (как правило, применяется в меню),
* 	 ![M 6](/uploads/007/m-6.jpg "M 6") «плоский» вид кнопки с пиктограммой (панель инструментов),
* 	![M 7](/uploads/007/m-7.jpg "M 7")  вид кнопки, имеющей как пиктограмму, так и надпись (панель инструментов),
* 	 ![M 8](/uploads/007/m-8.jpg "M 8") кнопка, имеющая вид ссылки,
* 	![M 9](/uploads/007/m-9.png "M 9")  альтернативный вариант отображения кнопки экранной формы.
  
Наиболее часто используемые кнопки <ОК> и <Отмена> предназначены для подтверждения пользователем сделанного выбора, внесенных изменений и т.п. и отказа от них соответственно.

Наличие справа от подписи кнопки значка  , говорит о том, что нажатие данной кнопки откроет подменю для выбора конкретной команды.

## Поле ввода	


Поле ввода служит для ввода текстовых значений пользователем с клавиатуры. Поле ввода всегда имеет подпись и выглядит, как показано на рисунке:
![6](/uploads/007/6.jpg "6")
Признаком того, что поле ввода находится в фокусе (активно и готово ко вводу значения) является присутствие в поле курсора – мигающей вертикальной черты.

На поля ввода могут быть наложены условия, позволяющие валидировать (контролировать правильность ввода) введенные значения, такие как маска ввода, например «___-___-___ __» - маска ввода номера СНИЛС. 

Условия, наложенные на значение поля, могут никак не отображаться в самом поле ввода, но при попытке ввести или сохранить некорректное значение, пользователь увидит сообщение об ошибке.

Поле ввода может быть предназначено для ввода данных различных типов: текст, число, дата и т.д. При этом поведение полей ввода разных типов будет разным, например поле ввода числовых значений не допускает ввода текстовых символов, только цифры, знак десятичной запятой, знак минус.

## Поле ввода даты	



Поле ввода даты может иметь маску ввода (например «__.__.____») для упрощения и контроля процесса ввода даты. Возможные значения элементов даты перебираются нажатием кнопок [] и [] клавиатуры, при установке курсора в соответствующий раздел даты. Кроме того, поле ввода даты может быть представлено специальным элементом управления «Календарь».
Элемент управления «Календарь» предназначен для альтернативного способа ввода даты в поле ввода путем ее выбора из системного календаря. По умолчанию, как правило, календарь открывает текущий месяц и выделяет в нем текущую дату. Одинарным щелчком мыши может быть выбрана любая дата отображаемого месяца. Выбрать другой месяц можно кнопками-стрелками расположенными у заголовка месяца. 

Если поле даты уже имеет введенное значение, календарь откроется с отображением месяца, соответствующего указанной дате. Текущая дата при этом будет видна и доступна для выбора в нижней части календаря.  ![7](/uploads/007/7.jpg "7")

Поле ввода даты имеет встроенную валидацию значения и не позволит ввести некорректную или несуществующую дату (13-ый месяц, число более 31, дату 30 февраля и т.п.)

## Поле с выпадающим списком	



Одним из способов контролировать правильность ввода данных является использование поля с выбором из фиксированного списка:
![8](/uploads/007/8.jpg "8")
Его внешний вид аналогичен обычному полю ввода с тем отличием, что в правой части поля виден дополнительный элемент-кнопка, при нажатии на которую раскрывается т.н. выпадающий список, из которого может быть выбрано нужное значение.
Если поле с выпадающим списком находится в фокусе, содержимое поля выделяется цветом. При выходе из поля выделение цветом пропадает.

С помощью клавиатуры список выбора может быть раскрыт с помощью клавиш [Alt]+ [↓]  .Перемещение по списку происходит с помощью клавиш [↑] и [↓], нужный элемент выбирается клавишей [Enter].Нажатие клавиши [↓] вместо [Alt]+[↓] будет последовательно перебирать возможные значения без раскрытия выпадающего списка, что может быть удобно для небольших списков выбора.

В полях типа «Дата» данная кнопка открывает элемент управления «Календарь», описанный ниже.

## Поле с выбором из справочника	


Для обеспечения правильности и удобства ввода в поле там где это возможно, используется выбор значения из справочника. Поле с выбором из справочника имеет следующий вид:
![9](/uploads/007/9.jpg "9")
 .
Нажатие кнопки с многоточием открывает диалоговое окно выбора ([см. п. 6.1](#b8)). Аналогичный эффект достигается нажатием клавиши [F3]. Диалоговое окно позволяет найти нужное значение с помощью средств поиска/фильтрации и подтвердить выбор с помощью кнопки <OK>.

Поле с выбором из справочника позволяет начать набирать нужное значение в поле (как правило, достаточно ввести первые 2-3 символа), последующее нажатие клавиши [Tab] открывает диалоговое окно выбора, в котором список выбора отфильтрован соответствующим образом.
Текст в поле может иметь вид ссылки ![10](/uploads/007/10.jpg "10")

Курсор мыши при наведении его на такое поле принимает вид ![2](/uploads/007/2-.png "2")  и двойной клик левой кнопкой мыши открывает форму редактирования данного значения справочника (если это разрешено правами пользователя).


 ##  Нередактируемое поле


Нередактируемые поля используются для отображения информации, которая не может быть изменена в рамках данной формы, но требуется пользователю в качестве справки. Нередактируемое поле имеет подпись, как и обычное, но его значение отображается не в поле ввода, а в виде статичного текста, выделенного жирным шрифтом, как это показано на рисунке.

![11](/uploads/007/11.png "11")

Текст, соответствующий значению поля, может быть выделен, как ссылка (см. рисунок). Щелчок мышью на такой ссылке открывает соответствующую форму редактирования в режиме, соответствующем правам пользователя.

![12](/uploads/007/12.png "12")


## Флажок (переключатель)	



Удобным элементом управления в тех случаях, когда атрибут или параметр может принимать только одно из двух значений, является «флажок», или переключатель: ![13](/uploads/007/13.png "13") , который имеет два состояния – включен или выключен. Каждый клик мышью на флажке изменяет его состояние. Аналогичное действие производится с помощью клавиши [Пробел].

## Зависимые переключатели


Еще один вариант отображения значений, имеющих только два состояния, - группа зависимых переключателей. Такой переключатель внешне похож на флажок ([см. п. 5.6](#b5)), но его особенность в том, что такие переключатели объединяются в группу и их не может быть меньше двух. Включение одного переключателя в группе вызывает отключение всех других, т.е. в группе может быть включен только один переключатель. Пример переключателя «Пациент/Представитель пациента» показан на рисунке:

![14](/uploads/007/14.png "14")

## Поле-список	

Некоторые поля ввода разрешают выбор нескольких значений одновременно. В таких случаях может применяться список выбора, имеющий следующий вид:

![15](/uploads/007/15.jpg "15")

Список содержит все возможные значения и флажки для отметки (включения) нужной позиции списка. Для перемещения по списку кроме мыши можно использовать клавиши [↑] и [↓], для отметки нужного значения - [Пробел].

## Древовидный список (дерево)	


СТРЕЛОЧКИ В ТЕКСТЕ

Иерархический список (древовидный список, дерево) используется, когда между элементами списка существуют иерархические связи. Т.е. одни элементы подчинены (входят в состав) других элементов. Начальный уровень дерева, с которого начинается ветвление, называется корневым.

Наличие символа «+» у элемента (узла) дерева означает, что в составе данного узла имеются вложенные элементы, т.е. данный раздел имеет подразделы. Щелчок мышью на значке «+» разворачивает раздел, т.е. делает видимыми и доступными для выбора его подразделы. При этом символ «+» меняется на «-». Щелчок на значке «-» сворачивает раздел (скрывает его подразделы). Аналогичный эффект имеет двойной щелчок мышью (левой кнопкой мыши) на заголовке раздела.

![16](/uploads/007/16.png "16") 

Двойной щелчок мышью на конечном элементе дерева, т.е. не имеющем подразделов, открывает окно, соответствующе выбранному элементу.
Навигация по списку с помощью клавиатуры:
•	[↑] и [↓] перемещают фокус на один элемент списка вверх или вниз от текущего;
•	[→] раскрывает список подчиненных элементов выделенного узла дерева (т.е. равноценно щелчку мышью на символе «+»);
•	[→] сворачивает раскрытый список подчиненных элементов (аналогично щелчку мышью на символе «-»;
•	нажатие [Enter] открывает окно отображения данных, соответствующих выделенному конечному элементу дерева;
•	[Ctrl+←] и [Ctrl+→] прокручивает содержимое панели влево или вправо.

Каждый узел дерева может быть снабжен пиктограммой. Чаще всего используются стандартные пиктограммы Windows для папок.

## Всплывающая подсказка	


Для удобства пользователя и упрощения процесса изучения системы элементы управления обладают т.н. всплывающей подсказкой. Подсказка выводит на экран краткое пояснение по функциональности указанного элемента. Всплывающая подсказка появляется при наведении указателя мыши на визуальный элемент управления, как это показано на рисунке:

![17](/uploads/007/17.jpg "17")

## Контекстное меню	

Контекстное меню, в отличие от, например, главного меню системы, не имеет определенного положения в окне программы, а открывается в месте расположения указателя мыши и состав его пунктов зависит от ряда факторов, т.е. от текущего контекста: местоположения указателя мыши, прав пользователя и т.д.
Контекстное меню вызывается одинарным щелчком правой кнопки мыши в нужном месте экранной формы, например, при наведении указателя мыши на элемент списка, определенную панель и т.д.

## Прочие визуальные элементы	

Перечисленные в таблице ниже элементы не являются элементами управления, а служат для организации рабочего пространства форм.


|||
| ------------- | ------------- |
|Панель|Панель служит для организации пространства экранной формы и, как правило, группирует однотипные элементы. Например, на Рис. можно видеть панель главного меню, панель инструментов, панель структуры приложения и т.д.<br>Вместе с панелями часто применяется элемент «Разделитель»  для визуального разделения групп логически связанных элементов, расположенных на панели.|
|Вкладка|Элемент управления «Вкладка» является одним из способов организации доступа к экранным формам. Вкладки позволяют разместить несколько форм отображения данных в одной области окна приложения и переключаться между ними при необходимости с помощью ярлыков. Вкладка состоит из панели для размещения визуальных элементов управления и ярлыка. Ярлыки вкладок чаще всего располагаются сверху, но могут быть расположены и внизу от области отображения данных. Ярлык имеет подпись, соответствующую наименованию экранной формы. На представленном рисунке показан пример вкладок панели структуры приложения. На ней ярлыки размещены внизу и имеют подписи «Папки» и «Избранное». Вкладка «Папки» является активной (отображается «поверх» вкладки «Избранное»).<br>Переключение между вкладками производится одинарным кликом мыши на ярлыке вкладки. [Подраздел 4.5](#b5) Руководства описывает работу со вкладками на примере области отображения данных главного окна приложения. ![18](/uploads/007/18.png "18") |
|Полоса прокрутки|Наличие на форме или отдельном элементе управления (панели, списке, и т.п.) полосы прокрутки (горизонтальной ![19](/uploads/007/19.jpg "19") или вертикальной) говорит о том, что не все содержимое данной области формы отображается на экране. Положение бегунка полосы прокрутки показывает, какая область формы видна, а по его размеру можно судить о размерах невидимой области – чем он меньше, тем больше данных остаются невидимыми. Сдвиг бегунка с помощью мыши открывает скрытые участки (прокручивает содержимое) области экрана. Аналогично перемещение по содержимому области экрана с помощью клавиш навигации ([Tab] и стрелки) будет автоматически пролистывать содержимое внутри области с полосой прокрутки.|
|Сплиттер|Иногда удобно изменить соотношение по занимаемой площади между разделами формы. Например, область формы, отведенная под панель структуры приложения (см. Рис.), может быть сужена или расширена с помощью т.н. «сплиттера» - элемента управления, расположенного на границе между панелью структуры приложения и областью отображения данных. При наведении курсора мыши на эту границу он принимает вид двунаправленной стрелки. Нажав и удерживая левую кнопку мыши, можно переместить границу влево или вправо до нужного положения.|


# Диалоговые окна	

Как уже было сказано, окна для работы с данными открываются в виде вкладок в области отображения данных главного окна приложения. Исключение из этого правила составляют диалоговые окна, которые используются в тех случаях, когда системе требуется получить ответ пользователя для дальнейшего продолжения работы. Диалоговое окно (или диалог) открывается «поверх» главного окна программы и блокирует все элементы интерфейса главного окна. Таким образом, пользователь может продолжить работу с приложением только после того, как закроет диалоговое окно. Такое окно еще называется модальным.

Среди всех возможных видов диалоговых окон системы может быть выделено несколько часто встречающихся видов диалоговых окон. Они описаны ниже в настоящем разделе Руководства.

## Диалог выбора значения	

Диалог данного типа предназначен для предоставления пользователю возможности выбора нужного значения из объемного справочника. Окно выбора состоит из списка значений и кнопок подтверждения выбора (<ОК>), и отмены, т.е. отказа от выбора (<Отмена>). Список значений может быть представлен табличной формой, древовидным списком и т.п. Окно выбора может также содержать инструменты поиска нужного значения в списке. Выбранный элемент выделяется в списке одинарным кликом мыши и выбор подтверждается кнопкой <ОК>. При отказе от выбора кнопкой <Отмена> диалоговое окно закрывается и пользователь возвращается в ту позицию, где он находился, когда был вызван диалог выбора.

## Диалог подтверждения удаления	

Попытка удаления каких-либо данных вызывает появление диалогового окна с запросом подтверждения удаления (см. Рис.). Это делается для снижения вероятности случайного удаления данных. Появление запроса позволяет проверить уверенность пользователя в выбранном действии. 


![20](/uploads/007/20.png "20")

Если в системе существуют данные, связанные с удаляемым объектом, удаление невозможно, и в таком случае будет выведено сообщение об ошибке ([см. п. 6.3](#b2)), описание ошибки содержит текст «Есть связанные объекты…».

<a name="b2"></a>
## Диалог сообщения об ошибке	

При попытке выполнить недопустимое действие в системе выводится сообщение об ошибке, аналогичное одному из показанных на рисунках ниже.

![21](/uploads/007/21.png "21")  ![22](/uploads/007/22.png "22")

Текст сообщения об ошибке зависит от типа недопустимой ситуации. Содержимое ошибки можно скопировать в буфер памяти с помощью кнопки «Копировать» или сохранить на диск в виде файла XML. Закрыть окно ошибки можно с помощью кнопки «ОК», при этом действие, на котором возникла ошибка, не будет выполнено.

## Диалог предупреждающего сообщения	

В некоторых случаях системе требуется сообщить пользователю информацию предупреждающего характера. Для этого используется диалог предупреждающего сообщения (в отличие от сообщения об ошибке), пример которого показан на Рис. 
Нажатие кнопки <ОК> в окне диалога является подтверждением того, что пользователь ознакомился с сообщением. Диалог при этом закрывается и пользователь продолжает работу.

![23](/uploads/007/23.png "23")


## Диалог ввода параметров	

В ряде случаев система запрашивает у пользователя значения параметров, необходимых для выполнения какой-либо процедуры, например, при наложении фильтра на данные табличной формы или формировании отчета. Диалог запроса параметров выглядит так, как это показано на Рис.

![24](/uploads/007/24.png "24")

Левая часть диалога содержит список параметров, которые необходимо указать. В верхней правой части окна на светло-желтом фоне отображается приглашение для ввода. В нижней правой части – панель ввода значения выделенного в списке параметра. Вид панели ввода значения будет зависеть от типа параметра.

Состав списка параметров зависит от конкретной задачи и, поэтому может быть разным в разных диалогах.

Кнопка <Готово> закрывает диалог и запускает выполнение процедуры, для которой запрашивались параметры. Кнопка <Отмена> позволяет отказаться от ввода параметров, и, соответственно, запуска процедуры. Кнопка <Пропустить> помещает пустое значение в текущий параметр и переходит к заполнению следующего (если параметров в списке больше одного).


# Универсальная табличная форма	

Для отображения объемных списков данных используется универсальная табличная форма. В общем случае форма включает функционал по отображению данных в виде таблицы, в ячейках которой отображаются данные, средства анализа данных списка и редактированию элементов списка. 

Каждая табличная форма связана с определенной сущностью системы (текущая сущность). Например, форма отображения списка медицинских организаций связана с сущностью «Медицинская организация». Заголовки колонок соответствуют атрибутам текущей сущности, сущностей, с ней связанных или значениям, вычисляемым на их основе. Каждая строка таблицы отображает соответствующие атрибуты конкретного экземпляра сущности.

На Рис.  представлено главное окно приложения с открытой табличной формой на примере справочника МНН:
* Панель инструментов приложения содержит группу кнопок управления данными формы. Функции управления данными описаны в [п. 7.4](#b10).
* Верхнюю часть вкладки справочника занимает панель фильтра, по умолчанию она свернута. Подробно средства фильтрации данных описаны в [п. 7.3](#b11).
* Собственно табличная форма занимает оставшуюся часть рабочей области вкладки. Первая строка таблицы – это область заголовков колонок. Кроме отображения наименований атрибутов заголовки таблицы также являются элементами управления, [см. пп. 7.1](#b12) и [7.2](#b13)
* Панель статуса главного окна приложения содержит строку состояния, которая отображает справочную информацию по активной вкладке. В частности, общее количество строк таблицы и из них количество выделенных.

![25](/uploads/007/25.jpg "25")

Стандартная табличная форма списка имеет дополнительные режимы функционирования (опции):
* 	режим выбора позиции списка;
* 	режим отображения древовидной структуры;
* 	режим множественного выбора позиций списка.

Доступность опций в каждом конкретном случае определяет разработчик системы.

В режиме выбора форма списка открывается, как правило, в модальном окне. Пример такого окна показан на Рис. В нижней части формы располагается панель с кнопками управления, всю остальную область формы занимает форма списка с панелью фильтра.

В списке требуется найти нужную позицию, в т.ч. используя средства поиска и/или фильтрации ([см. подразделы 7.1](#b12) и [7.2](#b13)), и затем подтвердить выбор нажатием кнопки <ОК>. Кнопкой <Отмена> можно отказаться от выбора и закрыть окно.

В режиме выбора доступны все те же самые функции управления формой, что и в обычном режиме.

![26](/uploads/007/26.png "26")

В некоторых случаях для навигации по спискам с большим количеством элементов удобно использовать древовидную группировку элементов списка. На Рис. показан пример справочника МКБ, в котором элементы справочника группируются в классы и рубрики.

![27](/uploads/007/27.png "27")

Выделение элемента в древовидном списке автоматически обновляет содержимое табличного списка, фильтруя его по указанной группе. На рисунке видно, что список содержит только позиции выбранной рубрики A16. Корневой элемент дерева отображает полный список элементов справочника.

![28](/uploads/007/28.png "28")

Режим множественного выделения возможен, когда допускаются групповые операции – действия, производимые не над одним элементом списка, а над группой. На Рис. показан пример табличной формы в режиме множественного выбора. В строке информации соответственно отображается количество выделенных элементов списка.

## Настройка внешнего вида	

Настройка внешнего вида списка (таблицы) производится с помощью контекстного меню строки заголовков (см. Рис.).

![29](/uploads/007/29.png "29")

Пункт <Выбрать атрибуты…> открывает диалог управления структурой и внешним видом табличной формы, функции которого описаны ниже в данном подразделе. Настроенные с помощью описанного инструмента колонки отображаются в контекстном меню панели заголовков табличной формы (см. Рис.) для возможности их быстрого отключения/включения.
Настройки внешнего вида табличной формы сохраняются в профиле сделавшего их пользователя. При следующем открытии формы (в т.ч. после повторного входа в систему) форма будет иметь тот же вид.
Пункт контекстного меню <Сбросить настройки приложения> позволяет отменить все пользовательские настройки и вернуться к изначальному виду таблицы.


### Настройка отображения сетки таблицы	



Кроме настройки количества, порядка и содержимого колонок можно включить режим отображения сетки в табличной форме с помощью кнопки ![30](/uploads/007/30.jpg "30") , расположенной над списком атрибутов. По умолчанию сетка таблицы не отображается.


### Настройка колонок	


Диалоговое окно настройки внешнего вида списка показано на Рис.  В верхней части окна слева отображается наименование сущности, для которой настраивается форма.
В центре окна слева виден полный список атрибутов данной сущности, расположенных в алфавитном порядке (подробнее о сущностях, их атрибутах и стандартной форме списка атрибутов см. Руководство пользователя по генератору выражений). Справа от списка атрибутов располагается список отображаемых колонок формы. Назначение кнопок со стрелками в центре формы очевидно: одинарная стрелка ![31 1](/uploads/007/31-1.png "31 1")  или ![31 2](/uploads/007/31-2.png "31 2")  переносит выделенный элемент списка в соответствующий направлению стрелки список. Перенос элемента списка колонок в список атрибутов означает удаление колонки из списка отображаемых. Двойная стрелка  ![31 3](/uploads/007/31-3.png "31 3") переносит весь список атрибутов в список колонок целиком, ![31 4](/uploads/007/31-4.png "31 4")  - очищает список колонок.
Кнопки ![31 5](/uploads/007/31-5.png "31 5") / ![31 6](/uploads/007/31-6.png "31 6"), расположенные над списком колонок, позволяют управлять порядком отображения колонок в таблице – нажатие стрелки перемещает выделенный элемент списка на одну позицию вверх или вниз. В нижней части формы расположены поля для отображения наименования атрибута и отображения и редактирования наименования колонки, соответствующей этому атрибуту. Указанное здесь наименование колонки будет отображено на панели заголовков формы. Здесь же размещается поле для указания ширины данной колонки в пикселах.


![32](/uploads/007/32.jpg "32")

В данном разделе описана работа с базовым типом атрибута (отображается в списке атрибутов черным цветом). Кроме базового, существуют другие типы атрибутов – в частности, атрибуты-коллекции и вычисляемые атрибуты. Атрибуты-коллекции (обозначены пиктограммой ![32 1](/uploads/007/32-1.png "32 1") ) не могут быть включены в табличную форму в качестве колонок.
Использование вычисляемых атрибутов при настройке колонок табличной формы описано в [п. 7.1.3](#b14). Подробнее об атрибутах, их типах и правилах их использования см. Руководство пользователя по генератору выражений.

### Вычисляемые атрибуты	



Атрибут сущности вычисляемого типа выделяется в списке атрибутов синим цветом (см. Рис.  Диалог настройки внешнего вида списка). От базового типа атрибута вычисляемый отличается тем, что его значение не хранится в базе данных системы, а вычисляется во время работы системы по определенным правилам, задаваемым разработчиком. Вычисляемые атрибуты могут быть двух типов – простые и параметрические. Значение простого вычисляемого атрибута не зависит от текущего контекста и может быть вычислено без указания каких-либо дополнительных условий (параметров). Атрибут такого типа может быть включен в список отображаемых колонок также, как и атрибут базового типа.
Для параметрических вычисляемых атрибутов требуется указание значения параметра, который используется при вычислении. Например, в сущности «Пациент» может быть создан атрибут «Страховая компания». Поскольку пациент в разные периоды времени может быть застрахован в разных компаниях, данный атрибут является вычисляемым, т.к. его значение зависит от даты, по состоянию на которую нам нужна информация. Параметром в данном случае выступает дата.
Отображаются ли такие параметрические вычисляемые атрибуты в общем списке, определяет кнопка ![32 2](/uploads/007/32-2.jpg "32 2")  , расположенная над списком атрибутов (см. Рис.  Диалог настройки внешнего вида списка). Параметрический вычисляемый атрибут может быть включен в список отображаемых колонок стандартным образом. Далее требуется задать значение параметра с помощью кнопки ![32 3](/uploads/007/32-3.jpg "32 3")  , расположенной над списком отображаемых колонок. Кнопка доступна только в том случае, если выделена колонка, соответствующая вычисляемому атрибуту. Нажатие кнопки открывает форму генератора выражений, описанного в руководстве пользователя по генератору выражений.

## Сортировка и поиск	

### Простая сортировка	

При первом открытии (в рамках сессии работы с программой) данные табличной формы отсортированы по значениям колонки, заданной разработчиком.
Одинарный клик левой кнопкой мыши на заголовке любой из колонок включает режим сортировки данных в таблице по значению этой колонки. При этом в заголовке колонки появляется значок  , означающий, что в данный момент данные отсортированы в порядке возрастания для числовых значений и алфавитном порядке для текстовых. Повторный щелчок на этом же заголовке вызывает пересортировку данных в обратном порядке. Значок при этом меняется на  . Щелчок на заголовке другой колонки включает сортировку по этой колонке и отменяет ранее включенную сортировку по другим колонкам.
Следует иметь в виду, что сортировка по колонкам, содержащим вычисляемые значения, невозможна.

### Сортировка по нескольким колонкам	


Щелчок левой кнопкой мыши на заголовке колонки при нажатой клавише [Ctrl] не отменяет ранее включенную сортировку, что позволяет отсортировать данные по значениям нескольких колонок. При этом рядом со значком сортировки отображается порядковый номер колонки для сортировки:

![33](/uploads/007/33.png "33")
 
Приведенный пример говорит о том, что данные в этой таблице отсортированы: в первую очередь – по колонке «Фамилия», затем – по колонке «Имя» и затем – по колонке «Пол».
Одинарный клик на заголовке без удержания [Ctrl] приводит к отмене ранее установленной сортировки.

### Поиск значения в отсортированной колонке	

Поиск значения в колонке возможен в том случае, если данные отсортированы по этой колонке. Для поиска достаточно набрать на клавиатуре первые символы нужного значения. Набираемый текст отображается в первой строке данных таблицы, как показано на рисунке:

![34](/uploads/007/34.jpg "34")

Через некоторое время после окончания набора текста искомое значение, если оно найдено в таблице, будет выделено. Если найденное значение находится за пределами экрана, список будет прокручен для отображения найденной позиции. Если введенному тексту удовлетворяет несколько значений, выделено будет первое из них.

В случае сортировки по нескольким колонкам, быстрый поиск будет работать по колонке, первой в порядке сортировки. Следует иметь в виду, что данный вид поиска ищет значение только в начале строки содержимого ячейки. Для поиска, например, строки, входящей в текст ячейки таблицы, нужно использовать фильтры.

## Использование фильтров	

При работе с большими объемами данных возникает необходимость скрыть ненужную в данный момент информацию. Для этого используются фильтры. Фильтр содержит набор условий, которые накладываются на значения атрибутов сущности, представленной в табличной форме. Панель фильтра всегда присутствует на универсальной табличной форме и занимает верхнюю часть области данных открытой вкладки (см. Рис. Универсальная табличная форма).

### Панель фильтра	

Панель фильтра содержит поле фильтра и кнопки управления фильтрами. Поле фильтра (со светло-желтым фоном) показывает, какой фильтр в данный момент наложен на данные (если никакое условие не задано, поле фильтра содержит текст «Фильтр не задан»). Кнопка <Найти> обновляет данные табличной формы в соответствии с заданными условиями фильтра. Кнопка <Сброс> очищает условия фильтра (но не обновляет список данных, для этого нужно нажать кнопку <Найти>).

Для создания нового фильтра нужно щелкнуть левой кнопкой мыши на поле фильтра, при этом под панель фильтра разворачивается, уменьшая область отображения данных. Развернутая панель фильтра включает, кроме описанных выше элементов управления, форму генератора выражений, применяемого для создания условий фильтра, как это показано на Рис. 7.7. Генератор выражений и его использование подробно описаны в руководстве пользователя по генератору выражений.

![35](/uploads/007/35.jpg "35")

После создания условия фильтра его можно применить к списку данных таблицы с помощью кнопки <Найти>. Текст в поле фильтра при этом изменится соответствующим наложенному фильтру образом. Теперь панель фильтра может быть свернута к исходному состоянию кнопкой   в правом верхнем углу панели фильтра и в любой момент открыта снова щелчком мыши на заголовке фильтра.

После нажатия кнопки «Сброс» условия фильтра удаляются и, если определенные условия фильтра используются неоднократно, их можно сохранить для последующего применения. Функции, связанные с сохранением фильтров, описаны в [п. 7.3.2](#b15). настоящего руководства.

В условиях фильтра может быть применен параметр, значение которого требуется указать в момент наложения фильтра (см. руководство пользователя по генератору выражений, раздел «Пользовательский параметр»). В таком случае при применении фильтра кнопкой <Найти> на экране появится диалоговое окно запроса значения параметра ([см.п. 6.5](#b16).).


### Сохранение фильтра	


Кнопки управления сохранением фильтров сгруппированы в правой части панели фильтра (см. Рис.). Созданный фильтр может быть сохранен для последующего использования с помощью кнопки  ![S 1](/uploads/007/s-1.jpg "S 1") (данная кнопка недоступна, пока не заданы условия фильтра). При нажатии на кнопку открывается диалог сохранения фильтра (Рис.), где нужно ввести наименование фильтра.

![40](/uploads/007/40.jpg "40") ![41](/uploads/007/41.png "41")

Чтобы создаваемый фильтр был виден не только пользователю, создавшему фильтр, нужно включить флажок «Доступен всем».
Чтобы применить ранее сохраненный фильтр, нужно выбрать его с помощью кнопки ![S 2](/uploads/007/s-2.jpg "S 2")  . Нажатие кнопки открывает подменю, которое содержит перечень всех ранее сохраненных фильтров и пункт <Настройка…>. Выбор опции с наименованием нужного фильтра применит условия этого фильтра к списку данных и соответствующим образом изменит текст, отображаемый в поле фильтра.
Опция «Настройка» открывает диалог управления списком сохраненных фильтров (см. Рис. ). С помощью данного диалога можно удалить ненужные фильтры.

## Функции работы с данными	

Универсальная табличная форма включает функции, связанные с обработкой данных списка. Их перечень представлен в [табл. 7.1](#b12).


|   |   |  |
|:------------- |:---------------:| :-------------|
|Новый	|![1 1](/uploads/007/1-1.jpg "1 1")|Создание нового элемента списка (экземпляра сущности, связанной с данной табличной формой). При выборе команды открывается форма редактирования в режиме создания (поля формы не заполнены).Если при создании нового элемента возможны какие-то варианты (например, создание новых элементов разного типа), подпись кнопки добавления содержит значок   и нажатие на кнопку открывает дополнительный список выбора нужной опции.|
|Свойства|![1 2](/uploads/007/1-2.jpg "1 2")|Редактирование выделенного элемента списка. Открывается форма редактирования*, связанная с данной сущностью, поля которой заполнены значениями атрибутов выбранного элемента списка.|
|Удалить|![1 3](/uploads/007/1-3.jpg "1 3")|Выделенный в момент нажатия кнопки элемент списка удаляется. При этом выводится стандартный запрос подтверждения удаления (п. 6.2). Если существуют связанные с выбранным элементом данные, удаление невозможно и будет выведено соответствующее сообщение.|
|Обновить|![1 4](/uploads/007/1-4.jpg "1 4")|Команда позволяет обновить данные списка, т.е. загрузить их заново из базы данных. Функция может понадобиться, если форма была открыта и не использовалась в течение какого-то времени, за которое данные в БД могли измениться.<br>При работе с элементами списка – добавление, удаление, редактирование список обновляется автоматически.|
|Экспортировать объекты списка|![1 5](/uploads/007/1-5.jpg "1 5")|Функция позволяет выгрузить данные списка в документ, сохраняемый на компьютере пользователя. Описание функции экспорта приведено в [п. 7.5](#b17).|

Форма редактирования может быть открыта в виде новой вкладки в области отображения данных, либо в виде диалогового окна. Режим открытия формы редактирования для каждой сущности задается разработчиком системы.

## Экспорт данных	

Содержимое табличной формы может быть экспортировано (выгружено) в файл, сохраняемый на компьютере пользователя. Кнопка  панели инструментов открывает диалог выбора формата файла:

![42](/uploads/007/42.png "42")

После выбора формата и подтверждения операции кнопкой «Ок» сформируется файл и откроется с помощью соответствующей программы. Допустимые форматы файлов и соответствующие им программы:
* HTML: файл с расширением htm, интернет-браузер по умолчанию;
* MS Excel: файл с расширением xls, MS Excel*;
* MS Word: файл с расширением doc, MS Word*;
* Текст: файл с расширением txt, программа по умолчанию для текстовых файлов, например, блокнот Windows.
* 
Программа должна быть установлена на компьютере пользователя.
Имя файла генерируется автоматически и созданный файл сохраняется в папку …\AppData\Local\Temp\ESTDV_TEMP\ObjectsListExport, соответствующую личной папке пользователя Windows.

# Формы вложенных списков

Формы вложенных списков используются для отображения различных списков, встроенных в формы редактирования, например, список полисов пациента, спецификация накладной и т.п. Такой список обладает ограниченной функциональностью по сравнению с универсальной табличной формой, описанной в [п. 7](#b18). Вложенные списки имеют несколько различных реализаций. В данном разделе описаны общие принципы их функционирования. Особенности списков для каждой конкретной задачи описаны в соответствующих руководствах пользователя.

## Отображение списков

Различные варианты формы списка приведены на рисунках данного раздела. Список всегда имеет строку заголовков колонок списка и сетку таблицы, в которой отображаются данные. Выделенная строка отображается контрастным по отношению к цвету фона цветом. Перемещение по списку производится клавишами стрелок вверх-вниз или выделением нужной строки кликом мыши.

![43](/uploads/007/43.png "43") ![44](/uploads/007/44.jpg "44")

Форма списка может быть снабжена краткой информацией по функциям работы со списком, например:

![45](/uploads/007/45.png "45")

## Функции управления списком	

В таблице приведены основные функции (команды) управления списком и способы их вызова.


|  Команда | Клавиши  |Элемент интерфейса  | Описание|
|:------------- |:---------------:| :-------------:|:-------------|
|Добавить|[Insert]	|![Q 1](/uploads/007/q-1.jpg "Q 1")|Создание нового элемента списка. При выборе команды открывается соответствующая списку форма редактирования в режиме создания (поля формы не заполнены).На форме, использующей список, могут быть предусмотрены команды (кнопки) для создания элементов списка разных типов.|
|Открыть|[Enter]|![Q 2](/uploads/007/q-2.jpg "Q 2")|Редактирование выделенного элемента списка. Открывается соответствующая списку форма редактирования, поля которой заполнены значениями выбранного элемента списка.<br>Двойной клик мышью также вызывает выполнение этой команды.|
|Удалить|[Delete]|![Q 3](/uploads/007/q-3.jpg "Q 3")|Выделенный в момент нажатия кнопки элемент списка удаляется. При этом выводится стандартный запрос подтверждения удаления ([п. 6.2](#b19)). Если существуют связанные с выбранным элементом данные, удаление невозможно и будет выведено соответствующее сообщение.|

Формы списков могут иметь также средства редактирования данных непосредственно в ячейках таблицы списка. Пример такой формы показан на Рис.

![46](/uploads/007/46.png "46")



