<!-- TITLE: Загрузка фактических данных из внешнего файла -->
<!-- SUBTITLE: Рабочая инструкция  -->

# Введение
Данная инструкция описывает функционал по загрузке фактических данных из внешнего файла в АИС «ОМС Финанс».

Следует иметь в виду, что скриншоты экранных форм приложения, приведенные в данной инструкции, могут в точности не совпадать с их фактическим внешним видом. Это связано с тем, что экранные формы в ряде случаев строятся на основании настроек приложения, которые могут быть различны в различных регионах и в разные периоды времени.

Для загрузки данных в систему пользователю необходимо подготовить файл в соответствии с требованиями к загрузочной таблице:


* Формат таблицы xls.
* В файле должны присутствовать колонки с именно такими заголовками, как приведено в шаблоне.
* Будут грузиться все листы, на которых есть данные. Поэтому лишние листы нужно удалить.
* Внутри ячеек таблицы не допускается вставка переводов строки.
* Не должно быть итогов на листе.
* В таблице не должно быть дубликатов.

Структура файла для загрузки фактических показателей должна выглядеть следующим образом:

| Колонка  | Тип данных  | Описание |
|:------------- |:---------------:| :-------------|
| Index     | цифра(12)| Номер строки по порядку |
|SMO     | цифра(5)      | Федеральный код СМО  |
| MCOD | цифра(6)        |        Федеральный код МО |
| FactYear      | цифра(4) |    Выгружаемый период (год) |
| PeriodSection     | строка        |       Выгружаемый период (квартал): Настройки планирования -> Разделы периодов -> колонка "Псевдоним" |
| RFINTYPE | цифра(1)|      Тип финансирования: Справочники -> Региональные справочники -> 1 уровень  -> колонка "Код|
| RMEDICALTYPE    | цифра(1) | Условия оказания МП: Справочники -> Региональные справочники -> 2 уровень -> колонка "Код" |
| RPROFILETYPE   | цифра(2)     |      Группировка профилей МП: Справочники -> Региональные справочники -> 3 уровень -> колонка "Код" |
| RPROFILE | строка       |    Профиль: Справочники -> Региональные справочники -> 4 уровень -> колонка "Код" |
| RKSGTYPE     | цифра(1) |    Тип значния для колонки 5 уровень: 0 - КСГ, 1 - ВМП, 2 - Услуга |
| RKSG    | строка    |        КСГ, ВМП, Отдельные виды услуг:Справочники -> Региональные справочники -> КСГ, Группы ВМП, Виды услуг -> колонка "Код" |
| PlanParameter   | строка |    Единица учета: Настройки планирования -> Параметры планирования -> колонка "Псевдоним" |
| Value      | Число с плавающей точкой        |        Число единиц учета (случаев, УЕТ и пр.)  |
| ValueSum |Число с плавающей точкой      |        Сумма в рублях |


После подготовки файла пользователю системы необходимо двойным кликом мыши открыть приложение  **<Rloader>**, таким образом, разворачивается окно приложения, которое показано на рисунке ниже:
![1 2](/uploads/001/1-2.png "1 2" ) 
В данном окне необходимо открыть папку FACT. В нее вставить скопированный подготовленный файл для загрузки, переименовать его, назвав точно так же как предыдущий файл для загрузки, который находится в этой папке - Fact_Template.xls, после чего старый файл необходимо удалить.

Следующим шагом необходимо вернуться в папку Rloader, (Рис.2), в ней запустить приложение  ![3 2](/uploads/001/3-2.png "3 2"). 

После чего, разворачивается окно, которое показано на рисунке ниже:
![2 2](/uploads/001/2-2.png "2 2")
В данном окне необходимо нажать кнопку <Старт>. Таким образом, произойдет загрузка данных в систему. После чего, приложение можно закрыть.   
