<!-- TITLE: Генератор отчетов -->
<!-- SUBTITLE: Руководство пользователя системы «ВИТАКОР» -->

# Введение
Настоящее руководство (далее – Руководство) является частью комплекта справочной документации по приложениям компании «Витакор» (далее – приложение, информационная
система, система), содержит описание возможностей и функционала встроенных генераторов отчетов и рассчитано на пользователя, знакомого с базовым руководством пользователя и руководством пользователя по редактору выражений.

Генератор отчетов представляет собой модуль, который является составной частью программных продуктов компании «Витакор». Модуль предназначен для создания форм отчетов и формирования готовых отчетов (заполнение форм данными). Генератор позволяет создавать и редактировать ранее созданные отчеты без привлечения разработчиков системы, силами
подготовленного пользователя или администратора.

Разъяснение по вопросу применяемой терминологии:
В ИТ-среде существует устоявшаяся практика применения термина «Отчет» в двух различных значениях:
* 	отчет, как готовая заполненная данными отчетная форма, в виде бумажного документа или документа в электронном виде (текстовый файл, электронная таблица и др.);
* 	и отчет, как шаблон отчета, т.е. набор инструкций по формированию отчета, предназначенный для использования в программе (например, rpt-файл
программы Crystal Reports и др.).

В настоящем документе там, где значение слова «отчет» может быть истолковано по- разному, термин «отчет» применяется в первом указанном выше значении, а термин
«шаблон отчета» - во втором. Также, при упоминании словосочетания «формирование отчета» имеется в виду первое значение, т.е. формирование данных отчета, а «создание отчета» означает процесс создания, настройки шаблона отчета, в соответствии с которым будет формироваться отчет, т.е. отбираться и обрабатываться его данные.

# 	Общие сведения
Отчет – документ, формируемый на основе данных, хранящихся в БД приложения. Как правило, отчет имеет форму таблицы (или нескольких таблиц), и даже если отчет имеет нетабличную выходную форму, его данные всегда могут быть представлены в виде таблицы.

На Рис. 1.1 показана структура отчета на примере Формы 12 «Сведения о числе заболеваний,
зарегистрированных у больных…». Практически любой отчет имеет аналогичную структуру. В более простом случае отчет может состоять только из одного вложенного отчета и может не иметь
заголовков строк.

![1](/uploads/0-gen-otch/1.png "1")


В системе реализованы два инструмента создания отчетов:
* 	Генератор списочных отчетов;
* 	Генератор универсальный.

Каждый из генераторов реализует следующие функции:
* 	ведение списка отчетов;
* 	создание, редактирование и сохранение в БД шаблона отчета;
* 	создание/подключение шаблона печатной формы отчета (допустимые форматы описаны в п. 1.3);
* 	выгрузка шаблона отчета в файл и загрузка из файла;
* 	настройка прав на отчет для ролей пользователей системы;
* 	формирование отчета по заданному шаблону на основании данных БД
1. 	в виде интерактивной формы в составе приложения;
2. 	в виде электронного документа, открываемого с помощью сторонней программы, соответствующей типу выходного файла (MS Excel, MS Word).

Файл шаблона отчета может быть загружен в БД другой инсталляции приложения и использован для формирования отчетов **без возможности редактирования шаблона.**

Процесс разработки отчета включает следующие этапы:
* 	разработка шаблона отчета с помощью генератора, встроенного в приложение, и сохранение его в БД системы;
* 	разработка шаблона печатной формы отчета с помощью соответствующего приложения (MS Word или MS Excel).

## 	Генератор списочных отчетов
Генератор т.н. «списочных» отчетов – это самое простое средство создания отчета. Структура и внешний вид списочного отчета определяются шаблоном отчета, созданным с помощью внешней
программы – например, MS Office (.doc, .docx, .xls, xlsx). В шаблоне списочного отчета в приложении задается сущность, данные которой будут использованы при формировании отчета, правило отбора данных сущности и права доступа к отчету. Наполнение шаблона списочного отчета
данными определяется т.н. управляющими инструкциями, включенными в шаблон.

Использование генератора списочных отчетов описано в п. 3 настоящего руководства.

## 	Генератор отчетов
В табличной форме данные выводятся в направлении т.н. «осей» отчета – заголовки колонок представляют собой одну ось (ось X), заголовки строк – другую ось (ось Y). Двумерный отчет
содержит две оси вывода данных (обычная таблица), трехмерный – три и т.д. Т.о. каждая из «осей» отчета содержит определенный набор показателей, значения которых будут отбираться и/или
вычисляться в процессе формирования отчета и выводиться в ячейках таблицы, соответствующих области данных. Наименования этих показателей выводятся в качестве заголовков столбцов (в
случае оси X), строк (ось Y) таблицы.

**Способы отображения дополнительных осей отчета.**

Вышесказанное проиллюстрировано Рис. 1.2, где показан образец структуры вложенного отчета, описанный в терминах генератора отчетов.

![2](/uploads/0-gen-otch/2.png "2")

Каждой «оси» отчета соответствует т.н. «Группировщик»: сущность, описывающая структуру оси – количество показателей, порядок их следования и группировку.
Группировщик, в свою очередь, содержит составные элементы – группы, соответствующие заголовкам и подзаголовкам строк или столбцов отчета. Из схемы видно, что группы могут иметь иерархические связи между собой. Каждый группировщик связывается с определенностью сущностью БД системы и для каждой его группы указываются правила отбора данных и расчета значения.

На пересечении групп по различным осям отчета, в области данных, располагаются собственно данные отчета. Содержимое ячейки отчета на пересечении областей данных групп определяется правилами, заданными для этих групп.

Руководствуясь данным описанием структуры отчета можно выделить следующий перечень и последовательность разработки составных элементов отчета:
* 	Вложенные отчеты;
* 	Для каждого вложенного отчета: группировщики, их количество, расположение;
* 	Для каждого группировщика: группы, их количество и отношения между ними.

Важно для всех элементов отчета подобрать информативные наименования для того, чтобы в дальнейшем, при использовании и редактировании отчета можно было легко читать его структуру.

Генератор универсальный (далее – просто «генератор»), описан на примере процесса создания нового отчета в п. 3.4.


## 	Допустимые форматы отчета

**-	документа MS Word (.doc);<br>-	электронной таблицы MS Excel (.xls);<br>-	документа HTML;<br>-	текстового документа.<br>
Для возможности создания шаблона отчета на компьютере пользователя должна быть установлена программа, соответствующая требуемому формату отчета.**

# 	Ведение справочника отчетов
Ведение справочника отчетов, подключенных к приложению, ведется с помощью раздела «Отчеты» панели структуры приложения. Двойной щелчок мышью на корневом элементе ветки («Отчеты») открывает перечень списочных отчетов. Вложенные элементы папки «Отчеты» соответствуют отчетам, созданным с помощью универсального генератора:
* 	«Генератор отчетов» содержит полный перечень отчетов,
* 	«Отчеты из файла» отображает список импортированных отчетов.
* 	
Списки отчетов ведутся с помощью стандартной табличной формы, где панель инструментов формы содержит кнопки для стандартных функций управления списком (создание, удаление и т.д.). Список «Генератор отчетов» имеет относительно стандартного набора функций дополнительные, описанные в таблице ниже.




